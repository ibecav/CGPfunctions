<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Plot2WayAnova • CGPfunctions</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Plot2WayAnova">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-117082388-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117082388-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CGPfunctions</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Using-Plot2WayANOVA.html">Using Plot2WayAnova</a>
    </li>
    <li>
      <a href="../articles/Using-PlotXTabs.html">Using PlotXTabs</a>
    </li>
    <li>
      <a href="../articles/Using-newggslopegraph.html">Using newggslopegraph</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ibecav/CGPfunctions">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using Plot2WayAnova</h1>
                        <h4 class="author">Chuck Powell</h4>
            
            <h4 class="date">2019-03-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ibecav/CGPfunctions/blob/master/vignettes/Using-Plot2WayANOVA.Rmd"><code>vignettes/Using-Plot2WayANOVA.Rmd</code></a></small>
      <div class="hidden name"><code>Using-Plot2WayANOVA.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The CGPfunctions package includes functions that I find useful for teaching statistics especially to novices (as well as an opportunity to sharpen my own R skills). I only write functions when I have a real need – no theory – just help for actually practicing the art. They typically are not “new” methods but rather wrappers around either base R or other packages and are very task focused. This vignette covers two functions from the package that try and help users (especially students) do one thing well by pulling together pieces from a variety of places. They are as follows:</p>
<ul>
<li>
<code>Plot2WayANOVA</code> which as the name implies conducts a 2 way ANOVA and plots the results using <code>ggplot2</code>
</li>
<li>
<code>neweta</code> which is a helper function that appends the results of a Type II eta squared calculation onto a classic ANOVA table</li>
</ul>
</div>
<div id="vignette-info" class="section level2">
<h2 class="hasAnchor">
<a href="#vignette-info" class="anchor"></a>Vignette Info</h2>
<p>The ANOVA family of statistical techniques allow us to compare mean differences of one outcome (dependent) variable across two or more groups (levels) of one or more independent variables (factor). It is also true that ANOVA is a special case of the GLM or regression models so as the number of levels increase it might make more sense to try one of those approaches. The 2 Way ANOVA allows for comparisons of mean differences across 2 independent variables <code>factors</code> with a varying numbers of <code>levels</code> in each <code>factor</code>.</p>
<p>The <code>Plot2WayANOVA</code> function conducts a classic analysis of variance (ANOVA) using existing R functions and packages in a sane and defensible manner not necessarily in the one and only manner.</p>
</div>
<div id="scenario-and-data" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-and-data" class="anchor"></a>Scenario and data</h2>
<p>Imagine that you are interested in understanding whether a car’s fuel efficiency (mpg) varies based upon the type of transmission (automatic or manual) and the number of cylinders the engine has. Let’s imagine that the <code>mtcars</code> data set is actually a random sample of 32 cars from different manufacturers and use the mean <code>mpg</code> by <code>am</code> and <code>cyl</code> to help inform our thinking. While we expect variation across our sample we’re interested in whether the differences between the means by grouping of transmission type and cylinders is significantly different than what we would expect in random variation across the data.</p>
<p>In simplistic terms we want to know whether <code>am</code> matters, <code>cyl</code> matters or if it depends on the interaction of the two. It’s this interaction term that typically confuses novices or is difficult to “see”. That’s where a good interaction graph can hopefully play a key role, and that’s what the <code>Plot2WayANOVA</code> focuses on.</p>
<p>There’s no lack or tools or capabilities in base R or in the many packages to do this task. What this function tries to do is pull together the disparate pieces with a set of sane defaults and a simple interface to work with it. At its simplest you would require the library and then enter this command:</p>
<p><code><a href="../reference/Plot2WayANOVA.html">Plot2WayANOVA(mpg~am*cyl, mtcars)</a></code> which lays our question out in R’s vernacular with a formula and a dataframe. Optionally we can specify a different confidence level and choose a line or a bar graph.</p>
<p>“Under the hood”, however there’s a lot of nice features at work.</p>
<ol style="list-style-type: decimal">
<li>Some basic error checking to ensure a valid formula and dataframe. The function accepts only a fully crossed formula to check for interaction term</li>
<li>It ensures the dependent (outcome) variable is numeric and that the two independent (predictor) variables already are or can be coerced to factors – the user is warned on the console if there are problems</li>
<li>A check is conducted to see if any of the variables of interest have missing cases – the user is warned on the console if there are problems</li>
<li>A summarized table of means, standard deviations, standard errors of the means, confidence intervals, and group sizes for each of the crossed combinations in our example that’s 6 groupings 3 levels of cylinder and 2 levels of automatic or manual</li>
<li>In addition to the classic ANOVA table eta squared <span class="math inline">\(\eta^2\)</span> is calculated and appended as an additional column. If you’re unfamiliar with them and want to know more especially where the numbers come from I recommend a good introductory stats text. As noted earlier I recommend <em>Learning Statistics with R</em> <a href="http://dj-navarro.appspot.com/lsr/lsr-0.5.1.pdf">LSR</a> see Table 14-1 on page 432.</li>
<li>The Homogeneity of Variance assumption is tested with Brown-Forsythe</li>
<li>The normality assumption is tested with Shapiro-Wilk</li>
</ol>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Install from CRAN</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"CGPfunctions"</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># Or the development version from GitHub</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-6" title="6">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"ibecav/CGPfunctions"</span>)</a></code></pre></div>
<p>then load the library.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(CGPfunctions)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; Warning in checkMatrixPackageVersion(): Package version inconsistency detected.</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; TMB was built with Matrix version 1.2.15</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; Current Matrix version is 1.2.16</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; Please re-install 'TMB' from source using install.packages('TMB', type = 'source') or ask CRAN for a binary version of 'TMB' matching CRAN's 'Matrix' package</span></a></code></pre></div>
</div>
<div id="example-of-using-the-function" class="section level2">
<h2 class="hasAnchor">
<a href="#example-of-using-the-function" class="anchor"></a>Example of using the function</h2>
<p>The only two required parameters are a formula and a dataframe (like) object. If we run the function in its simplest form here’s what we get.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="../reference/Plot2WayANOVA.html">Plot2WayANOVA</a></span>(mpg<span class="op">~</span>am<span class="op">*</span>cyl, mtcars)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; Converting am to a factor --- check your results</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; Converting cyl to a factor --- check your results</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; --- </span><span class="al">WARNING</span><span class="co">! ---</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; You have an unbalanced design. Using Type II sum of squares, </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; to calculate factor effect sizes eta and omega </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; The R Squared reported is for the overall model but your </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; two factors account for ...</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; 0.684</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; of the type II sum of squares, as opposed to the</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; R Squared reported below for overall model fit!</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;        term   sumsq  meansq df statistic p.value etasq partial.etasq</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; 1        am  36.767  36.767  1     3.999   0.056 0.049         0.133</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; 2       cyl 456.401 228.200  2    24.819   0.000 0.602         0.656</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt; 3    am:cyl  25.437  12.718  2     1.383   0.269 0.034         0.096</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt; 4 Residuals 239.059   9.195 26        NA      NA    NA            NA</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt;   omegasq partial.omegasq cohens.f power</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; 1   0.036           0.086    0.392 0.515</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt; 2   0.571           0.598    1.382 1.000</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; 3   0.009           0.023    0.326 0.298</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; 4      NA              NA       NA    NA</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">#&gt; Measures of overall model fit</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">#&gt; # A tibble: 1 x 11</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt;   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; 1     0.788         0.747  3.03      19.3 5.18e-8     6  -77.6  169.  179.</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt; # … with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt; Table of group means</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; # A tibble: 6 x 9</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt; # Groups:   am [2]</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt;   am    cyl   TheMean TheSD TheSEM CIMuliplier LowerBound UpperBound     N</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt; 1 0     4        22.9 1.45   0.839        4.30       19.3       26.5     3</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt; 2 0     6        19.1 1.63   0.816        3.18       16.5       21.7     4</span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt; 3 0     8        15.0 2.77   0.801        2.20       13.3       16.8    12</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#&gt; 4 1     4        28.1 4.48   1.59         2.36       24.3       31.8     8</span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co">#&gt; 5 1     6        20.6 0.751  0.433        4.30       18.7       22.4     3</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt; 6 1     8        15.4 0.566  0.4         12.7        10.3       20.5     2</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#&gt; Testing Homogeneity of Variance with Brown-Forsythe</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co">#&gt;    *** Possible violation of the assumption ***</span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="co">#&gt;       Df F value  Pr(&gt;F)  </span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="co">#&gt; group  5   2.736 0.04086 *</span></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="co">#&gt;       26                  </span></a>
<a class="sourceLine" id="cb3-53" title="53"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb3-54" title="54"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb3-55" title="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-56" title="56"><span class="co">#&gt; Testing Normality Assumption with Shapiro-Wilk</span></a>
<a class="sourceLine" id="cb3-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-58" title="58"><span class="co">#&gt;  Shapiro-Wilk normality test</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-60" title="60"><span class="co">#&gt; data:  MyAOV_residuals</span></a>
<a class="sourceLine" id="cb3-61" title="61"><span class="co">#&gt; W = 0.96277, p-value = 0.3263</span></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-63" title="63"><span class="co">#&gt; Interaction graph plotted...</span></a></code></pre></div>
<p><img src="Using-Plot2WayANOVA_files/figure-html/Plot2WayANOVA-1.png" width="576"></p>
</div>
<div id="credits" class="section level2">
<h2 class="hasAnchor">
<a href="#credits" class="anchor"></a>Credits</h2>
<p>Many thanks to Dani Navarro and the book &gt; (<a href="http://www.compcogscisydney.com/learning-statistics-with-r.html">Learning Statistics with R</a>) whose etaSquared function was the genesis of <code>neweta</code>.</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.” (<a href="https://twitter.com/hadleywickham/status/504368538874703872">via</a>)</p>
</blockquote>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#vignette-info">Vignette Info</a></li>
      <li><a href="#scenario-and-data">Scenario and data</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#example-of-using-the-function">Example of using the function</a></li>
      <li><a href="#credits">Credits</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Chuck Powell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
