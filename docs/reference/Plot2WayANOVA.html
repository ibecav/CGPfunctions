<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a 2 Way ANOVA using dplyr and ggplot2 — Plot2WayANOVA • CGPfunctions</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Plot a 2 Way ANOVA using dplyr and ggplot2 — Plot2WayANOVA" />

<meta property="og:description" content="Takes a formula and a dataframe as input, conducts an analysis of variance
prints the results (AOV summary table, table of overall model information 
and table of means) then uses ggplot2 to plot an interaction graph (line 
or bar) .  Also uses Brown-Forsythe test for homogeneity of
variance.  Users can also choose to save the plot out as a png file." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117082388-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117082388-1');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CGPfunctions</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Using-Plot2WayANOVA.html">Using Plot2WayAnova</a>
    </li>
    <li>
      <a href="../articles/Using-PlotXTabs.html">Using PlotXTabs</a>
    </li>
    <li>
      <a href="../articles/Using-newggslopegraph.html">Using newggslopegraph</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ibecav/CGPfunctions">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a 2 Way ANOVA using dplyr and ggplot2</h1>
    <small class="dont-index">Source: <a href='https://github.com/ibecav/CGPfunctions/blob/master/R/Plot2WayANOVA.R'><code>R/Plot2WayANOVA.R</code></a></small>
    <div class="hidden name"><code>Plot2WayANOVA.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Takes a formula and a dataframe as input, conducts an analysis of variance
prints the results (AOV summary table, table of overall model information 
and table of means) then uses ggplot2 to plot an interaction graph (line 
or bar) .  Also uses Brown-Forsythe test for homogeneity of
variance.  Users can also choose to save the plot out as a png file.</p>
    
    </div>

    <pre class="usage"><span class='fu'>Plot2WayANOVA</span>(<span class='no'>formula</span>,
               <span class='kw'>dataframe</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
               <span class='kw'>confidence</span><span class='kw'>=</span><span class='fl'>.95</span>,
               <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"line"</span>,
               <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
               <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
               <span class='kw'>title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
               <span class='kw'>subtitle</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
               <span class='kw'>interact.line.size</span> <span class='kw'>=</span> <span class='fl'>2</span>,
               <span class='kw'>ci.line.size</span> <span class='kw'>=</span> <span class='fl'>1</span>,
               <span class='kw'>mean.label</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
               <span class='kw'>mean.ci</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
               <span class='kw'>mean.size</span> <span class='kw'>=</span> <span class='fl'>4</span>,
               <span class='kw'>mean.shape</span> <span class='kw'>=</span> <span class='fl'>23</span>,
               <span class='kw'>mean.color</span> <span class='kw'>=</span> <span class='st'>"darkred"</span>,
               <span class='kw'>mean.label.size</span> <span class='kw'>=</span> <span class='fl'>3</span>,
               <span class='kw'>mean.label.color</span> <span class='kw'>=</span> <span class='st'>"black"</span>,
               <span class='kw'>offset.style</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
               <span class='kw'>overlay.type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
               <span class='kw'>posthoc.method</span> <span class='kw'>=</span> <span class='st'>"scheffe"</span>,
               <span class='kw'>show.dots</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
               <span class='kw'>PlotSave</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula with a numeric dependent (outcome) variable, 
and two independent (predictor) variables e.g. <code>mpg ~ am * vs</code>.
The independent variables are coerced to factors (with warning) if 
possible.</p></td>
    </tr>
    <tr>
      <th>dataframe</th>
      <td><p>a dataframe or an object that can be coerced to a dataframe</p></td>
    </tr>
    <tr>
      <th>confidence</th>
      <td><p>what confidence level for confidence intervals</p></td>
    </tr>
    <tr>
      <th>plottype</th>
      <td><p>bar or line (quoted)</p></td>
    </tr>
    <tr>
      <th>xlab, ylab</th>
      <td><p>Labels for `x` and `y` axis variables. If `NULL` (default),
variable names for `x` and `y` will be used.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>The text for the plot title. A generic default is provided.</p></td>
    </tr>
    <tr>
      <th>subtitle</th>
      <td><p>The text for the plot subtitle. If `NULL` (default), key
model information is provided as a subtitle.</p></td>
    </tr>
    <tr>
      <th>interact.line.size</th>
      <td><p>Line size for the line connecting the group means
(Default: `2`).</p></td>
    </tr>
    <tr>
      <th>ci.line.size</th>
      <td><p>Line size for the confidence interval bracketing 
the group means (Default: `1`).</p></td>
    </tr>
    <tr>
      <th>mean.label</th>
      <td><p>Logical that decides whether the value of the group 
mean is to be displayed (Default: `FALSE`).</p></td>
    </tr>
    <tr>
      <th>mean.ci</th>
      <td><p>Logical that decides whether the confidence interval for 
group means is to be displayed (Default: `TRUE`).</p></td>
    </tr>
    <tr>
      <th>mean.size</th>
      <td><p>Point size for the data point corresponding to mean
(Default: `4`).</p></td>
    </tr>
    <tr>
      <th>mean.shape</th>
      <td><p>Shape of the plot symbol for the mean
(Default: `23` which is a diamond).</p></td>
    </tr>
    <tr>
      <th>mean.color</th>
      <td><p>Color for the data point corresponding to mean (Default:
`"darkred"`).</p></td>
    </tr>
    <tr>
      <th>mean.label.size, mean.label.color</th>
      <td><p>Aesthetics for
the label displaying mean. Defaults: `3`, `"black"`, respectively.</p></td>
    </tr>
    <tr>
      <th>offset.style</th>
      <td><p>A character string (e.g., `"wide"` or `"narrow"`, 
or `"none"`) which controls whether items are offset from the
centerline for clarity. Useful when you want to add individual
datapoints or confdence interval lines overlap. (Default: `"none"`).</p></td>
    </tr>
    <tr>
      <th>overlay.type</th>
      <td><p>A character string (e.g., `"box"` or `"violin"`), 
if you wish to overlay that information on factor1</p></td>
    </tr>
    <tr>
      <th>posthoc.method</th>
      <td><p>A character string, one of "hsd", "bonf", "lsd", 
"scheffe", "newmankeuls", defining the method for the pairwise comparisons. 
(Default: `"scheffe"`).</p></td>
    </tr>
    <tr>
      <th>show.dots</th>
      <td><p>Logical that decides whether the individual data points 
are displayed (Default: `FALSE`).</p></td>
    </tr>
    <tr>
      <th>PlotSave</th>
      <td><p>a logical indicating whether the user wants to save the plot
as a png file</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 5 elements which is returned invisibly. These items
  are always sent to the console for display but for user convenience 
  the function also returns a named list with the following items
  in case the user desires to save them or further process them -
  <code>$ANOVATable</code>,<code>$ModelSummary</code>, <code>$MeansTable</code>, 
  <code>$PosthocTable</code>, <code>$BFTest</code>, and <code>$SWTest</code>.
  The plot is always sent to the default plot device</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Details about how the function works in order of steps taken.</p><ol>
<li><p>Some basic error checking to ensure a valid formula and dataframe.
  Only accepts fully *crossed* formula to check for interaction term</p></li>
<li><p>Ensure the dependent (outcome) variable is numeric and that the two
  independent (predictor) variables are or can be coerced to factors -- user
  warned on the console</p></li>
<li><p>Remove missing cases -- user warned on the console</p></li>
<li><p>Calculate a summarized table of means, sds, standard errors of the
   means, confidence intervals, and group sizes.</p></li>
<li><p>Use <code><a href='https://www.rdocumentation.org/packages/stats/topics/aov'>aov</a></code> function to execute an Analysis of 
  Variance (ANOVA)</p></li>
<li><p>Use <code><a href='https://www.rdocumentation.org/packages/sjstats/topics/eta_sq'>anova_stats</a></code> to calculate eta squared 
  and omega squared values per factor. If the design is unbalanced warn  
  the user and use Type II sums of squares</p></li>
<li><p>Produce a standard ANOVA table with additional columns</p></li>
<li><p>Use the <code><a href='https://www.rdocumentation.org/packages/DescTools/topics/PostHocTest'>PostHocTest</a></code> for producing a table 
  of post hoc comparisons for all effects that were significant</p></li>
<li><p>Use the <code><a href='https://www.rdocumentation.org/packages/car/topics/leveneTest'>leveneTest</a></code> for testing Homogeneity 
  of Variance assumption with Brown-Forsythe</p></li>
<li><p>Use the <code><a href='https://www.rdocumentation.org/packages/DescTools/topics/PostHocTest'>PostHocTest</a></code> for conducting 
  post hoc tests for effects that were significant</p></li>
<li><p>Use the <code><a href='https://www.rdocumentation.org/packages/stats/topics/shapiro.test'>shapiro.test</a></code> for testing normality
  assumption with Shapiro-Wilk</p></li>
<li><p>Use <code>ggplot2</code> to plot an interaction plot of the type the 
  user specified.</p></li>
</ol><p>The defaults are deliberately constructed to emphasize the nature
  of the interaction rather than focusing on distributions. So
  while a violin plot of the first factor by level is displayed
  along with dots for individual data points shaded by the second 
  factor, the emphasis is on the interaction lines.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>: ANOVA: Delacre, Leys, Mora, &amp; Lakens, *PsyArXiv*, 2018</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/stats/topics/aov'>aov</a></code>, <code><a href='https://www.rdocumentation.org/packages/car/topics/leveneTest'>leveneTest</a></code>,
<code><a href='https://www.rdocumentation.org/packages/sjstats/topics/eta_sq'>anova_stats</a></code>, <code><a href='https://www.rdocumentation.org/packages/stats/topics/replications'>replications</a></code>,
<code><a href='https://www.rdocumentation.org/packages/stats/topics/shapiro.test'>shapiro.test</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>Plot2WayANOVA</span>(<span class='no'>mpg</span> ~ <span class='no'>am</span> * <span class='no'>cyl</span>, <span class='no'>mtcars</span>, <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"line"</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting am to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting cyl to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>				--- WARNING! ---</span>
#&gt; <span class='message'>		You have an unbalanced design. Using Type II sum of </span>
#&gt; <span class='message'>              squares, to calculate factor effect sizes eta and omega.</span>
#&gt; <span class='message'>              The R Squared reported is for the overall model but your </span>
#&gt; <span class='message'>              two factors account for 0.684 of the type II sum of </span>
#&gt; <span class='message'>              squares, as opposed to the 0.788 reported below for </span>
#&gt; <span class='message'>              overall model fit!</span></div><div class='output co'>#&gt;        term   sumsq  meansq df statistic p.value etasq partial.etasq omegasq
#&gt; 1        am  36.767  36.767  1     3.999   0.056 0.049         0.133   0.036
#&gt; 2       cyl 456.401 228.200  2    24.819   0.000 0.602         0.656   0.571
#&gt; 3    am:cyl  25.437  12.718  2     1.383   0.269 0.034         0.096   0.009
#&gt; 4 Residuals 239.059   9.195 26        NA      NA    NA            NA      NA
#&gt;   partial.omegasq epsilonsq cohens.f power
#&gt; 1           0.086     0.036    0.392 0.515
#&gt; 2           0.598     0.578    1.382 1.000
#&gt; 3           0.023     0.009    0.326 0.298
#&gt; 4              NA        NA       NA    NA</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Measures of overall model fit</span></div><div class='output co'>#&gt; # A tibble: 1 x 11
#&gt;   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     0.788         0.747  3.03      19.3 5.18e-8     6  -77.6  169.  179.
#&gt; # … with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Table of group means</span></div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt; # Groups:   am [2]
#&gt;   am    cyl   TheMean TheSD TheSEM CIMuliplier LowerBound UpperBound     N
#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
#&gt; 1 0     4        22.9 1.45   0.839        4.30       19.3       26.5     3
#&gt; 2 0     6        19.1 1.63   0.816        3.18       16.5       21.7     4
#&gt; 3 0     8        15.0 2.77   0.801        2.20       13.3       16.8    12
#&gt; 4 1     4        28.1 4.48   1.59         2.36       24.3       31.8     8
#&gt; 5 1     6        20.6 0.751  0.433        4.30       18.7       22.4     3
#&gt; 6 1     8        15.4 0.566  0.4         12.7        10.3       20.5     2</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Post hoc tests for all effects that were significant</span></div><div class='output co'>#&gt; 
#&gt;   Posthoc multiple comparisons of means : Scheffe Test 
#&gt;     95% family-wise confidence level
#&gt; 
#&gt; $cyl
#&gt;          diff     lwr.ci     upr.ci    pval    
#&gt; 6-4 -4.756706 -10.029278  0.5158655 0.09684 .  
#&gt; 8-4 -7.329581 -11.723391 -2.9357710 0.00024 ***
#&gt; 8-6 -2.572874  -7.620978  2.4752288 0.64828    
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Homogeneity of Variance with Brown-Forsythe </span></div><div class='output co'>#&gt; <span class='message'>   *** Possible violation of the assumption ***</span></div><div class='output co'>#&gt; Levene's Test for Homogeneity of Variance (center = median)
#&gt;       Df F value  Pr(&gt;F)  
#&gt; group  5   2.736 0.04086 *
#&gt;       26                  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Normality Assumption with Shapiro-Wilk </span></div><div class='output co'>#&gt; 
#&gt; 	Shapiro-Wilk normality test
#&gt; 
#&gt; data:  MyAOV_residuals
#&gt; W = 0.96277, p-value = 0.3263
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Interaction graph plotted...</span></div><div class='img'><img src='Plot2WayANOVA-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>Plot2WayANOVA</span>(<span class='no'>mpg</span> ~ <span class='no'>am</span> * <span class='no'>cyl</span>,
              <span class='no'>mtcars</span>,
              <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"line"</span>,
              <span class='kw'>overlay.type</span> <span class='kw'>=</span> <span class='st'>"box"</span>,
              <span class='kw'>mean.label</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting am to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting cyl to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>				--- WARNING! ---</span>
#&gt; <span class='message'>		You have an unbalanced design. Using Type II sum of </span>
#&gt; <span class='message'>              squares, to calculate factor effect sizes eta and omega.</span>
#&gt; <span class='message'>              The R Squared reported is for the overall model but your </span>
#&gt; <span class='message'>              two factors account for 0.684 of the type II sum of </span>
#&gt; <span class='message'>              squares, as opposed to the 0.788 reported below for </span>
#&gt; <span class='message'>              overall model fit!</span></div><div class='output co'>#&gt;        term   sumsq  meansq df statistic p.value etasq partial.etasq omegasq
#&gt; 1        am  36.767  36.767  1     3.999   0.056 0.049         0.133   0.036
#&gt; 2       cyl 456.401 228.200  2    24.819   0.000 0.602         0.656   0.571
#&gt; 3    am:cyl  25.437  12.718  2     1.383   0.269 0.034         0.096   0.009
#&gt; 4 Residuals 239.059   9.195 26        NA      NA    NA            NA      NA
#&gt;   partial.omegasq epsilonsq cohens.f power
#&gt; 1           0.086     0.036    0.392 0.515
#&gt; 2           0.598     0.578    1.382 1.000
#&gt; 3           0.023     0.009    0.326 0.298
#&gt; 4              NA        NA       NA    NA</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Measures of overall model fit</span></div><div class='output co'>#&gt; # A tibble: 1 x 11
#&gt;   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     0.788         0.747  3.03      19.3 5.18e-8     6  -77.6  169.  179.
#&gt; # … with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Table of group means</span></div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt; # Groups:   am [2]
#&gt;   am    cyl   TheMean TheSD TheSEM CIMuliplier LowerBound UpperBound     N
#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
#&gt; 1 0     4        22.9 1.45   0.839        4.30       19.3       26.5     3
#&gt; 2 0     6        19.1 1.63   0.816        3.18       16.5       21.7     4
#&gt; 3 0     8        15.0 2.77   0.801        2.20       13.3       16.8    12
#&gt; 4 1     4        28.1 4.48   1.59         2.36       24.3       31.8     8
#&gt; 5 1     6        20.6 0.751  0.433        4.30       18.7       22.4     3
#&gt; 6 1     8        15.4 0.566  0.4         12.7        10.3       20.5     2</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Post hoc tests for all effects that were significant</span></div><div class='output co'>#&gt; 
#&gt;   Posthoc multiple comparisons of means : Scheffe Test 
#&gt;     95% family-wise confidence level
#&gt; 
#&gt; $cyl
#&gt;          diff     lwr.ci     upr.ci    pval    
#&gt; 6-4 -4.756706 -10.029278  0.5158655 0.09684 .  
#&gt; 8-4 -7.329581 -11.723391 -2.9357710 0.00024 ***
#&gt; 8-6 -2.572874  -7.620978  2.4752288 0.64828    
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Homogeneity of Variance with Brown-Forsythe </span></div><div class='output co'>#&gt; <span class='message'>   *** Possible violation of the assumption ***</span></div><div class='output co'>#&gt; Levene's Test for Homogeneity of Variance (center = median)
#&gt;       Df F value  Pr(&gt;F)  
#&gt; group  5   2.736 0.04086 *
#&gt;       26                  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Normality Assumption with Shapiro-Wilk </span></div><div class='output co'>#&gt; 
#&gt; 	Shapiro-Wilk normality test
#&gt; 
#&gt; data:  MyAOV_residuals
#&gt; W = 0.96277, p-value = 0.3263
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Interaction graph plotted...</span></div><div class='img'><img src='Plot2WayANOVA-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>Plot2WayANOVA</span>(<span class='no'>mpg</span> ~ <span class='no'>am</span> * <span class='no'>vs</span>, <span class='no'>mtcars</span>, <span class='kw'>confidence</span> <span class='kw'>=</span> <span class='fl'>.99</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting am to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting vs to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>				--- WARNING! ---</span>
#&gt; <span class='message'>		You have an unbalanced design. Using Type II sum of </span>
#&gt; <span class='message'>              squares, to calculate factor effect sizes eta and omega.</span>
#&gt; <span class='message'>              The R Squared reported is for the overall model but your </span>
#&gt; <span class='message'>              two factors account for 0.661 of the type II sum of </span>
#&gt; <span class='message'>              squares, as opposed to the 0.7 reported below for </span>
#&gt; <span class='message'>              overall model fit!</span></div><div class='output co'>#&gt;        term   sumsq  meansq df statistic p.value etasq partial.etasq omegasq
#&gt; 1        am 276.033 276.033  1    22.902   0.000 0.277         0.450   0.262
#&gt; 2        vs 367.411 367.411  1    30.484   0.000 0.369         0.521   0.352
#&gt; 3     am:vs  16.010  16.010  1     1.328   0.259 0.016         0.045   0.004
#&gt; 4 Residuals 337.476  12.053 28        NA      NA    NA            NA      NA
#&gt;   partial.omegasq epsilonsq cohens.f power
#&gt; 1           0.406     0.265    0.904 0.998
#&gt; 2           0.480     0.356    1.043 1.000
#&gt; 3           0.010     0.004    0.218 0.211
#&gt; 4              NA        NA       NA    NA</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Measures of overall model fit</span></div><div class='output co'>#&gt; # A tibble: 1 x 11
#&gt;   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
#&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     0.700         0.668  3.47      21.8 1.73e-7     4  -83.1  176.  184.
#&gt; # … with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Table of group means</span></div><div class='output co'>#&gt; # A tibble: 4 x 9
#&gt; # Groups:   am [2]
#&gt;   am    vs    TheMean TheSD TheSEM CIMuliplier LowerBound UpperBound     N
#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
#&gt; 1 0     0        15.0  2.77  0.801        3.11       12.6       17.5    12
#&gt; 2 0     1        20.7  2.47  0.934        3.71       17.3       24.2     7
#&gt; 3 1     0        19.8  4.01  1.64         4.03       13.2       26.3     6
#&gt; 4 1     1        28.4  4.76  1.80         3.71       21.7       35.0     7</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Post hoc tests for all effects that were significant</span></div><div class='output co'>#&gt; 
#&gt;   Posthoc multiple comparisons of means : Scheffe Test 
#&gt;     99% family-wise confidence level
#&gt; 
#&gt; $am
#&gt;         diff   lwr.ci   upr.ci    pval    
#&gt; 1-0 7.244939 2.619029 11.87085 5.3e-05 ***
#&gt; 
#&gt; $vs
#&gt;         diff   lwr.ci   upr.ci    pval    
#&gt; 1-0 6.732986 2.153198 11.31277 0.00013 ***
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Homogeneity of Variance with Brown-Forsythe </span></div><div class='output co'>#&gt; Levene's Test for Homogeneity of Variance (center = median)
#&gt;       Df F value Pr(&gt;F)
#&gt; group  3  0.8809 0.4629
#&gt;       28               </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Normality Assumption with Shapiro-Wilk </span></div><div class='output co'>#&gt; 
#&gt; 	Shapiro-Wilk normality test
#&gt; 
#&gt; data:  MyAOV_residuals
#&gt; W = 0.97845, p-value = 0.7535
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Interaction graph plotted...</span></div><div class='img'><img src='Plot2WayANOVA-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Create a new dataset</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>dplyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>stringi</span>)
<span class='no'>newmpg</span> <span class='kw'>&lt;-</span> <span class='no'>mpg</span> <span class='kw'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>cyl</span> <span class='kw'>!=</span> <span class='fl'>5</span>) <span class='kw'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>am</span> <span class='kw'>=</span> <span class='kw pkg'>stringi</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stringi/topics/stri_extract'>stri_extract</a></span>(<span class='no'>trans</span>, <span class='kw'>regex</span> <span class='kw'>=</span> <span class='st'>"auto|manual"</span>))
<span class='fu'>Plot2WayANOVA</span>(<span class='kw'>formula</span> <span class='kw'>=</span> <span class='no'>hwy</span> ~ <span class='no'>am</span> * <span class='no'>cyl</span>,
              <span class='kw'>dataframe</span> <span class='kw'>=</span> <span class='no'>newmpg</span>,
              <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Highway mileage"</span>,
              <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Transmission type"</span>,
              <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"line"</span>,
              <span class='kw'>offset.style</span> <span class='kw'>=</span> <span class='st'>"wide"</span>,
              <span class='kw'>overlay.type</span> <span class='kw'>=</span> <span class='st'>"box"</span>,
              <span class='kw'>mean.label</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
              <span class='kw'>mean.shape</span> <span class='kw'>=</span> <span class='fl'>20</span>,
              <span class='kw'>mean.size</span> <span class='kw'>=</span> <span class='fl'>5</span>,
              <span class='kw'>mean.label.size</span> <span class='kw'>=</span> <span class='fl'>5</span>,
              <span class='kw'>show.dots</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in Plot2WayANOVA(formula = hwy ~ am * cyl, dataframe = newmpg, ylab = "Highway mileage",     xlab = "Transmission type", plottype = "line", offset.style = "wide",     overlay.type = "box", mean.label = TRUE, mean.shape = 20,     mean.size = 5, mean.label.size = 5, show.dots = TRUE): That dataframe does not exist</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Chuck Powell</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Chuck Powell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

